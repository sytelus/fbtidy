<div class="fbNewsViewMain">
    <div data-bind="template: { name: 'postsTemplate', data: $data.fbNewsData.filtered}"></div>
    <div data-bind="with: fbNewsFetcher">
        <hr />
        <div class="pull-right">
            <button data-bind="click: fetchNext, visible: hasMoreResults() && !isInProgress()" 
                    class="btn btn-primary" type="button">More</button>
            <p class="small text-muted">
                Until <span data-bind="text: minPostDate"/>
            </p>
        </div>
    </div>
</div>



<!-- ko templates -->
<script type="text/html" id="postsTemplate">
    <ul class="list-unstyled" data-bind="foreach: $data">
        <li>
            <div data-bind="if: link.url">
                <div class="panel panel-default">
                    <div class="panel-body">
                        <span class="pull-right">
                            <a data-bind="attr: { href: link.url}"><img data-bind="attr: { src: link.preview}"></a>
                        </span>
                        <strong data-bind="text: from.name"/>
                        &nbsp;<span data-bind="text: message" />
                        <div class="bottom"><small class="small text-muted"><span data-bind="text: displayDate" /></small></div>
                    </div>
                </div>
            </div>
            <div data-bind="ifnot: link.url">
                <div class="panel panel-default">
                    <div class="panel-body">
                        <strong data-bind="text: from.name"/>
                        &nbsp;<span data-bind="text: message" />
                        &nbsp;&nbsp;<span class="pull-right"><small class="small text-muted"><span data-bind="text: displayDate" /></small></span>
                    </div>
                </div>
            </div>
        </li>
    </ul>
</script>
